var O=(t,e,s)=>{if(!e.has(t))throw TypeError("Cannot "+s)};var r=(t,e,s)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,s)};var n=(t,e,s)=>(O(t,e,"access private method"),s);import{c as S,a as q,b as A,r as P}from"./removeContentLoader-BsrSS4xz.js";const i={genresTypesList:document.querySelector(".genres__list"),genresMoviesBlock:document.querySelector(".genres__movies"),headerGenresLink:document.querySelector(".header-nav__link__genres"),scrollToTopBtn:document.querySelector(".genres-btn-up"),BtnTopProgressLine:document.querySelector(".genres-btn-up__line")};window.onscroll=x;i.scrollToTopBtn.addEventListener("click",H);function x(){if(j()){N(),_();return}D()}function H(){window.scrollTo({top:0,behavior:"smooth"})}function _(){const t=$();i.BtnTopProgressLine.style.strokeDasharray=`${t}, 100`}function j(){return document.body.scrollTop>100||document.documentElement.scrollTop>100}function N(){i.scrollToTopBtn.style.display="block"}function D(){i.scrollToTopBtn.style.display="none"}function $(){const{scrollTop:t,scrollHeight:e,clientHeight:s}=document.documentElement,c=t||document.body.scrollTop,v=e-s;return c/v*100}function U(){i.headerGenresLink.setAttribute("active","")}var u,G,m,k,g,C,f,E,a,y,p,w,l,L,b,F,B,I,o,h;class z{constructor(e){r(this,u);r(this,m);r(this,g);r(this,f);r(this,a);r(this,p);r(this,l);r(this,b);r(this,B);r(this,o);this.listCardsEl=e.querySelector(".cards-list"),this.fatherElement=e,this.btn,this.genresId,this.page=1,this.max_films,this.isNoBtn=!0}async setCardsOnGenres(e){if(!this.isNoBtn&&this.btn?n(this,a,y).call(this):this.isNoBtn=!1,n(this,u,G).call(this,e))return;this.setGenresId(e),this.listCardsEl.innerHTML="",this.resetPage(),await this.setCardsOfFilms()!=="error"&&n(this,f,E).call(this)}async setCardsOfFilms(){this.nextPage(),(this.page!==1||n(this,o,h).call(this))&&(n(this,p,w).call(this),n(this,b,F).call(this));let e;try{const s=await S(q,{genreId:this.genresId,page:this.page}),{cards:c,maxFilms:v}=s;n(this,m,k).call(this,c.join("")),n(this,g,C).call(this,v)}catch{e="error"}return n(this,o,h).call(this)&&(n(this,a,y).call(this),this.isNoBtn=!0),this.page!==1&&!n(this,o,h).call(this)&&(n(this,l,L).call(this),n(this,B,I).call(this)),_(),e==="error"?e:"ok"}setGenresId(e){this.genresId=e}nextPage(){this.page+=1}resetPage(){this.page=0}}u=new WeakSet,G=function(e){return this.genresId===e},m=new WeakSet,k=function(e){this.listCardsEl.insertAdjacentHTML("beforeend",e)},g=new WeakSet,C=function(e){this.max_films=e},f=new WeakSet,E=function(){this.fatherElement.insertAdjacentHTML("beforeend",'<button class="genres__bth-more">More movies</button>'),this.btn=document.querySelector(".genres__bth-more"),n(this,l,L).call(this)},a=new WeakSet,y=function(){this.btn.remove()},p=new WeakSet,w=function(){this.btn.removeEventListener("click",T)},l=new WeakSet,L=function(){this.btn.addEventListener("click",T)},b=new WeakSet,F=function(){this.btn.insertAdjacentHTML("beforeend",J())},B=new WeakSet,I=function(){this.btn.querySelector(".btnMoreLoader").remove()},o=new WeakSet,h=function(){return this.page*20>=this.max_films};function J(){return'<div class="btnMoreLoader"></div>'}let M=new z(i.genresMoviesBlock);function K(t){const e=t.target.closest(".genres__item");if(!e)return;const s=R(e);M.setCardsOnGenres(s),Q(e)}let d="";function Q(t){d!==t&&(d&&d.removeAttribute("active"),d=t,t.setAttribute("active",""))}function R(t){return t.dataset.genresId}function T(){M.setCardsOfFilms()}async function V(){const s=(await A()).genres.map(c=>W(c));i.genresTypesList.innerHTML=s.join("")}function W(t){const{id:e,name:s}=t;return`<li class="genres__item" data-genres-id="${e}">
            <button class="genres-item__btn">${s}</button>
          </li>
  `}U();await V();i.genresTypesList.addEventListener("click",K);P();
